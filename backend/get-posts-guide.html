<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Guide: Récupérer des Posts</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; line-height: 1.6; }
        h1 { color: #2c3e50; text-align: center; }
        h2 { color: #3498db; margin-top: 30px; }
        code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; }
        pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; }
        .step { background: #ecf0f1; padding: 20px; margin: 20px 0; border-radius: 5px; }
        .step-number { background: #3498db; color: white; display: inline-block; width: 30px; height: 30px; text-align: center; line-height: 30px; border-radius: 50%; margin-right: 10px; }
        img { max-width: 100%; border: 1px solid #ddd; border-radius: 5px; margin: 15px 0; }
        .note { background: #ffe6cc; padding: 10px; border-left: 4px solid #ff9800; margin: 15px 0; }
        .cta { background: #2ecc71; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>Guide: Comment récupérer des posts avec Postman</h1>

    <p>Ce guide vous montre comment utiliser Postman pour récupérer des posts à partir de votre API Go.</p>

    <div class="step">
        <h2><span class="step-number">1</span> Obtenir un token JWT</h2>
        <p>Avant de pouvoir accéder aux posts, vous devez obtenir un token d'authentification.</p>

        <h3>Étapes:</h3>
        <ol>
            <li>Ouvrez Postman</li>
            <li>Créez une nouvelle requête <strong>POST</strong></li>
            <li>URL: <code>http://localhost:8080/api/fake-login</code></li>
            <li>Cliquez sur "Send"</li>
            <li>Copiez le token de la réponse JSON</li>
        </ol>

        <pre>{
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "expires": "2025-06-22T00:07:46Z",
    "user_id": 1
}</pre>
    </div>

    <div class="step">
        <h2><span class="step-number">2</span> Configurer la requête GET pour les posts</h2>

        <h3>Paramètres de base:</h3>
        <ul>
            <li><strong>Méthode:</strong> GET</li>
            <li><strong>URL:</strong> <code>http://localhost:8080/api/posts</code></li>
        </ul>

        <h3>Headers requis:</h3>
        <p>Ajoutez le header d'autorisation avec votre token:</p>
        <ul>
            <li><strong>Key:</strong> Authorization</li>
            <li><strong>Value:</strong> Bearer <em>votre_token_ici</em></li>
        </ul>
    </div>

    <div class="step">
        <h2><span class="step-number">3</span> Paramètres optionnels de pagination</h2>

        <p>Vous pouvez ajouter des paramètres de requête pour la pagination:</p>

        <h3>Exemples:</h3>
        <ul>
            <li>Page spécifique: <code>http://localhost:8080/api/posts?page=2</code></li>
            <li>Taille de page: <code>http://localhost:8080/api/posts?pageSize=5</code></li>
            <li>Les deux: <code>http://localhost:8080/api/posts?page=2&pageSize=5</code></li>
            <li>Avec filtre de visibilité: <code>http://localhost:8080/api/posts?visibility=public</code></li>
        </ul>

        <div class="note">
            <strong>Note:</strong> Les valeurs par défaut sont page=1 et pageSize=10 si non spécifiées.
        </div>
    </div>

    <div class="step">
        <h2><span class="step-number">4</span> Exemple de réponse JSON</h2>

        <p>Voici un exemple de réponse que vous recevrez:</p>

        <pre>[
  {
    "ID": 1,
    "CreatedAt": "2025-06-21T12:34:56Z",
    "UpdatedAt": "2025-06-21T12:34:56Z",
    "DeletedAt": null,
    "CreatorID": 1,
    "Content": "Mon premier post",
    "Visibility": "public",
    "Media": [
      {
        "ID": 1,
        "MediaURL": "uploads/user_1_abc123.jpg",
        "MediaType": "image"
      }
    ]
  },
  {
    "ID": 2,
    "CreatedAt": "2025-06-21T13:45:30Z",
    "UpdatedAt": "2025-06-21T13:45:30Z",
    "DeletedAt": null,
    "CreatorID": 1,
    "Content": "Un autre post avec vidéo",
    "Visibility": "public",
    "Media": [
      {
        "ID": 2,
        "MediaURL": "uploads/user_1_def456.mp4",
        "MediaType": "video"
      }
    ]
  }
]</pre>
    </div>

    <div class="step">
        <h2><span class="step-number">5</span> Configuration d'un environnement Postman</h2>

        <p>Pour faciliter vos tests, créez un environnement avec des variables:</p>

        <ol>
            <li>En haut à droite de Postman, cliquez sur l'icône d'engrenage</li>
            <li>Ajoutez un nouvel environnement (ex: "API Locale")</li>
            <li>Ajoutez ces variables:
                <ul>
                    <li><strong>base_url:</strong> http://localhost:8080</li>
                    <li><strong>token:</strong> (laissez vide pour l'instant)</li>
                </ul>
            </li>
            <li>Sauvegardez l'environnement</li>
        </ol>

        <p>Maintenant vous pouvez utiliser <code>{{base_url}}/api/posts</code> comme URL et <code>Bearer {{token}}</code> comme valeur d'Authorization</p>
    </div>

    <div class="step">
        <h2><span class="step-number">6</span> Script automatique pour sauvegarder le token</h2>

        <p>Pour votre requête de login, ajoutez ce script dans l'onglet "Tests":</p>

        <pre>if (pm.response.code === 200) {
    var jsonData = pm.response.json();
    pm.environment.set("token", jsonData.token);
    console.log("Token JWT enregistré automatiquement");
}</pre>

        <p>Maintenant, chaque fois que vous faites la requête de login, le token sera automatiquement mis à jour dans vos variables d'environnement.</p>
    </div>

    <div class="step">
        <h2><span class="step-number">7</span> Récupération d'un post spécifique</h2>

        <p>Pour récupérer un post spécifique par son ID, il faudrait implémenter un endpoint supplémentaire.</p>

        <div class="note">
            <strong>Note:</strong> Actuellement, l'API ne semble pas avoir d'endpoint pour récupérer un post par ID. Vous pouvez récupérer tous les posts et filtrer côté client, ou implémenter cette fonctionnalité dans l'API.
        </div>
    </div>

    <div class="step">
        <h2><span class="step-number">8</span> Dépannage</h2>

        <h3>Erreurs courantes:</h3>
        <ul>
            <li><strong>401 Unauthorized</strong>: Token JWT invalide ou expiré</li>
            <li><strong>404 Not Found</strong>: URL incorrecte</li>
            <li><strong>500 Internal Server Error</strong>: Erreur côté serveur</li>
        </ul>

        <div class="note">
            <strong>Conseil:</strong> Si vous obtenez une erreur 401, essayez de générer un nouveau token.
        </div>
    </div>

    <p><a href="https://www.postman.com/downloads/" class="cta" target="_blank">Télécharger Postman</a></p>
</body>
</html>
